---
title: "Explore"
output: html_notebook
---

Loading libraries and functions
```{r}
library(tidyverse)
source(function.R) # for F1 calculation
```

# assuming all calls are true calls
```{r}
vcf <- read.csv("output/snv-parse-syn1.csv")
head(vcf)
```

```{r}
truth = read.table("data/syn1/syn1_truth.bed") 
mypred = vcf[,1:3]

calc.F1(mypred, truth)
```

```{r}
data <- c("syn1","syn2","syn3","syn4","syn5","real1","real2_part1")
truthfiles <- paste0("data/", data, "/", data, "_truth.bed")
truthfiles[7] = "data/real2_part1/real2_truth_chr1to5.bed"
vcffiles <- paste0("output/snv-parse-", data, ".csv")

res <- data.frame(dataset = character(),
                  TP = integer(), FP = integer(), FN = integer(), Precision = numeric(), Recall = numeric(), F1 = numeric())

for (i in 1:7){
  mypred <- read.csv(vcffiles[i])[,1:3]
  truth = read.table(truthfiles[i]) 
  f1stats <- calc.F1(mypred, truth)
  res[i,] = c(data[i], f1stats)
}

res
```

# specific calls are true calls
- based on type of software used

## mutect2
```{r}
mutect2 <- data.frame(dataset = character(),
                  TP = integer(), FP = integer(), FN = integer(), Precision = numeric(), Recall = numeric(), F1 = numeric())

for (i in 1:7){
  mypred <- read.csv(vcffiles[i]) %>%
    filter(FILTER_Mutect2) %>%
    select(1:3)
  truth = read.table(truthfiles[i]) 
  f1stats <- calc.F1(mypred, truth)
  mutect2[i,] = c(data[i], f1stats)
}

mutect2
```

## freebayes
```{r}
freebayes <- data.frame(dataset = character(),
                  TP = integer(), FP = integer(), FN = integer(), Precision = numeric(), Recall = numeric(), F1 = numeric())

for (i in 1:7){
  mypred <- read.csv(vcffiles[i]) %>%
    filter(FILTER_Freebayes) %>%
    select(1:3)
  truth = read.table(truthfiles[i]) 
  f1stats <- calc.F1(mypred, truth)
  freebayes[i,] = c(data[i], f1stats)
}

freebayes
```

## Vardict
```{r}
vardict <- data.frame(dataset = character(),
                  TP = integer(), FP = integer(), FN = integer(), Precision = numeric(), Recall = numeric(), F1 = numeric())

for (i in 1:7){
  mypred <- read.csv(vcffiles[i]) %>%
    filter(FILTER_Vardict) %>%
    select(1:3)
  truth = read.table(truthfiles[i]) 
  f1stats <- calc.F1(mypred, truth)
  vardict[i,] = c(data[i], f1stats)
}

vardict
```

## Varscan
```{r}
varscan <- data.frame(dataset = character(),
                  TP = integer(), FP = integer(), FN = integer(), Precision = numeric(), Recall = numeric(), F1 = numeric())

for (i in 1:7){
  mypred <- read.csv(vcffiles[i]) %>%
    filter(FILTER_Varscan) %>%
    select(1:3)
  truth = read.table(truthfiles[i]) 
  f1stats <- calc.F1(mypred, truth)
  varscan[i,] = c(data[i], f1stats)
}

varscan
```


